set_languages("c++11")
add_rules("mode.debug", "mode.release") 

add_requires("zlib")

add_includedirs("src")

target("routingkit_base")
    set_kind("static")
    add_files("src/routingkit/base/**.cpp")

target("routingkit_utils")
    set_kind("static")
    add_files("src/routingkit/utils/**.cpp")

target("routingkit_core")
    set_kind("static")
    add_files("src/routingkit/core/**.cpp")

target("routingkit")
    set_kind("static")
    add_files("src/routingkit/**.cpp")
    set_targetdir("lib")

-- common deps
add_packages("zlib")

-- $ for target in `ls test/|xargs -n1 basename|sed 's/\.cpp//g'`;do echo target\(\"$target\"\);echo "    "set_kind\(\"binary\"\); echo "    "add_files\(\"test/${target}.cpp\"\); echo "    "add_deps\(\"routingkit\"\); echo "    "set_targetdir\(\"bin/test\"\); done;
target("test_basic_features")
    set_kind("binary")
    add_files("test/test_basic_features.cpp")
    add_deps("routingkit")
    set_targetdir("bin/test")
target("test_bit_vector")
    set_kind("binary")
    add_files("test/test_bit_vector.cpp")
    add_deps("routingkit")
    set_targetdir("bin/test")
target("test_buffered_asynchronous_reader")
    set_kind("binary")
    add_files("test/test_buffered_asynchronous_reader.cpp")
    add_deps("routingkit")
    set_targetdir("bin/test")
target("test_contraction_hierarchy_extra_weight")
    set_kind("binary")
    add_files("test/test_contraction_hierarchy_extra_weight.cpp")
    add_deps("routingkit")
    set_targetdir("bin/test")
target("test_contraction_hierarchy_path_query")
    set_kind("binary")
    add_files("test/test_contraction_hierarchy_path_query.cpp")
    add_deps("routingkit")
    set_targetdir("bin/test")
target("test_contraction_hierarchy_pinned_query")
    set_kind("binary")
    add_files("test/test_contraction_hierarchy_pinned_query.cpp")
    add_deps("routingkit")
    set_targetdir("bin/test")
target("test_customizable_contraction_hierarchy")
    set_kind("binary")
    add_files("test/test_customizable_contraction_hierarchy.cpp")
    add_deps("routingkit")
    set_targetdir("bin/test")
target("test_customizable_contraction_hierarchy_customization")
    set_kind("binary")
    add_files("test/test_customizable_contraction_hierarchy_customization.cpp")
    add_deps("routingkit")
    set_targetdir("bin/test")
target("test_customizable_contraction_hierarchy_path_query")
    set_kind("binary")
    add_files("test/test_customizable_contraction_hierarchy_path_query.cpp")
    add_deps("routingkit")
    set_targetdir("bin/test")
target("test_customizable_contraction_hierarchy_perfect_customization")
    set_kind("binary")
    add_files("test/test_customizable_contraction_hierarchy_perfect_customization.cpp")
    add_deps("routingkit")
    set_targetdir("bin/test")
target("test_customizable_contraction_hierarchy_pinned_query")
    set_kind("binary")
    add_files("test/test_customizable_contraction_hierarchy_pinned_query.cpp")
    add_deps("routingkit")
    set_targetdir("bin/test")
target("test_customizable_contraction_hierarchy_reset")
    set_kind("binary")
    add_files("test/test_customizable_contraction_hierarchy_reset.cpp")
    add_deps("routingkit")
    set_targetdir("bin/test")
target("test_dijkstra")
    set_kind("binary")
    add_files("test/test_dijkstra.cpp")
    add_deps("routingkit")
    set_targetdir("bin/test")
target("test_geo_dist")
    set_kind("binary")
    add_files("test/test_geo_dist.cpp")
    add_deps("routingkit")
    set_targetdir("bin/test")
target("test_id_mapper")
    set_kind("binary")
    add_files("test/test_id_mapper.cpp")
    add_deps("routingkit")
    set_targetdir("bin/test")
target("test_id_set_queue")
    set_kind("binary")
    add_files("test/test_id_set_queue.cpp")
    add_deps("routingkit")
    set_targetdir("bin/test")
target("test_inverse_vector")
    set_kind("binary")
    add_files("test/test_inverse_vector.cpp")
    add_deps("routingkit")
    set_targetdir("bin/test")
target("test_nearest_neighbor")
    set_kind("binary")
    add_files("test/test_nearest_neighbor.cpp")
    add_deps("routingkit")
    set_targetdir("bin/test")
target("test_nested_dissection")
    set_kind("binary")
    add_files("test/test_nested_dissection.cpp")
    add_deps("routingkit")
    set_targetdir("bin/test")
target("test_osm_simple")
    set_kind("binary")
    add_files("test/test_osm_simple.cpp")
    add_deps("routingkit")
    set_targetdir("bin/test")
target("test_permutation")
    set_kind("binary")
    add_files("test/test_permutation.cpp")
    add_deps("routingkit")
    set_targetdir("bin/test")
target("test_protobuf")
    set_kind("binary")
    add_files("test/test_protobuf.cpp")
    add_deps("routingkit")
    set_targetdir("bin/test")
target("test_sort")
    set_kind("binary")
    add_files("test/test_sort.cpp")
    add_deps("routingkit")
    set_targetdir("bin/test")
target("test_strongly_connected_component")
    set_kind("binary")
    add_files("test/test_strongly_connected_component.cpp")
    add_deps("routingkit")
    set_targetdir("bin/test")
target("test_tag_map")
    set_kind("binary")
    add_files("test/test_tag_map.cpp")
    add_deps("routingkit")
    set_targetdir("bin/test")

-- $ for target in `ls examples/|xargs -n1 basename|sed 's/\.cpp//g'`;do echo target\(\"$target\"\);echo "    "set_kind\(\"binary\"\); echo "    "add_files\(\"examples/${target}.cpp\"\); echo "    "add_deps\(\"routingkit\"\); echo "    "set_targetdir\(\"bin/examples\"\);done;
target("compare_vector")
    set_kind("binary")
    add_files("examples/compare_vector.cpp")
    add_deps("routingkit")
    set_targetdir("bin/examples")
target("compute_contraction_hierarchy")
    set_kind("binary")
    add_files("examples/compute_contraction_hierarchy.cpp")
    add_deps("routingkit")
    set_targetdir("bin/examples")
target("compute_geographic_distance_weights")
    set_kind("binary")
    add_files("examples/compute_geographic_distance_weights.cpp")
    add_deps("routingkit")
    set_targetdir("bin/examples")
target("compute_nested_dissection_order")
    set_kind("binary")
    add_files("examples/compute_nested_dissection_order.cpp")
    add_deps("routingkit")
    set_targetdir("bin/examples")
target("convert_road_dimacs_coordinates")
    set_kind("binary")
    add_files("examples/convert_road_dimacs_coordinates.cpp")
    add_deps("routingkit")
    set_targetdir("bin/examples")
target("convert_road_dimacs_graph")
    set_kind("binary")
    add_files("examples/convert_road_dimacs_graph.cpp")
    add_deps("routingkit")
    set_targetdir("bin/examples")
target("decode_vector")
    set_kind("binary")
    add_files("examples/decode_vector.cpp")
    add_deps("routingkit")
    set_targetdir("bin/examples")
target("encode_vector")
    set_kind("binary")
    add_files("examples/encode_vector.cpp")
    add_deps("routingkit")
    set_targetdir("bin/examples")
target("examine_ch")
    set_kind("binary")
    add_files("examples/examine_ch.cpp")
    add_deps("routingkit")
    set_targetdir("bin/examples")
target("export_road_dimacs_graph")
    set_kind("binary")
    add_files("examples/export_road_dimacs_graph.cpp")
    add_deps("routingkit")
    set_targetdir("bin/examples")
target("generate_constant_vector")
    set_kind("binary")
    add_files("examples/generate_constant_vector.cpp")
    add_deps("routingkit")
    set_targetdir("bin/examples")
target("generate_dijkstra_rank_test_queries")
    set_kind("binary")
    add_files("examples/generate_dijkstra_rank_test_queries.cpp")
    add_deps("routingkit")
    set_targetdir("bin/examples")
target("generate_random_node_list")
    set_kind("binary")
    add_files("examples/generate_random_node_list.cpp")
    add_deps("routingkit")
    set_targetdir("bin/examples")
target("generate_random_source_times")
    set_kind("binary")
    add_files("examples/generate_random_source_times.cpp")
    add_deps("routingkit")
    set_targetdir("bin/examples")
target("generate_test_queries")
    set_kind("binary")
    add_files("examples/generate_test_queries.cpp")
    add_deps("routingkit")
    set_targetdir("bin/examples")
target("graph_to_dot")
    set_kind("binary")
    add_files("examples/graph_to_dot.cpp")
    add_deps("routingkit")
    set_targetdir("bin/examples")
target("graph_to_svg")
    set_kind("binary")
    add_files("examples/graph_to_svg.cpp")
    add_deps("routingkit")
    set_targetdir("bin/examples")
target("osm_extract")
    set_kind("binary")
    add_files("examples/osm_extract.cpp")
    add_deps("routingkit")
    set_targetdir("bin/examples")
target("randomly_permute_nodes")
    set_kind("binary")
    add_files("examples/randomly_permute_nodes.cpp")
    add_deps("routingkit")
    set_targetdir("bin/examples")
target("run_contraction_hierarchy_query")
    set_kind("binary")
    add_files("examples/run_contraction_hierarchy_query.cpp")
    add_deps("routingkit")
    set_targetdir("bin/examples")
target("run_dijkstra")
    set_kind("binary")
    add_files("examples/run_dijkstra.cpp")
    add_deps("routingkit")
    set_targetdir("bin/examples")
target("show_path")
    set_kind("binary")
    add_files("examples/show_path.cpp")
    add_deps("routingkit")
    set_targetdir("bin/examples")